// jquery.dragon.js
// ver. 0.1
// Petr Brzek
// the semi-colon before function invocation is a safety net against concatenated
// scripts and/or other plugins which may not be closed properly.
(function(e,t,n,r){function o(t,i){this.$element=e(t);this.elementH=this.$element.height();this.elementPos=0;this.mouseElPos=0;this.$doc=e(n);this.docH=this.$doc.height();s={limitTop:0,limitBottom:this.docH-this.$element.height()};this.options=e.extend({},s,i);this.containerTop=this.options.containerTop;this.containerBottom=this.options.containerBottom;this.limitTop=parseInt(this.options.limitTop,10);i.limitBottom!==r?this.limitBottom=parseInt(this.docH-this.$element.height()-this.options.limitBottom,10):this.limitBottom=parseInt(this.options.limitBottom,10);this.behavior()}var i="dragon",s;o.prototype.offsetTop=function(e){return e.offset().top-this.$window.scrollTop()};o.prototype.off=function(e){this.$doc.off(e)};o.prototype.css=function(e,t,n){return e.css(t,n+"px")};o.prototype.behavior=function(){var n=this;this.$element.on("mousedown",function(r){r.preventDefault();n.elementPos=r.pageY-n.offsetTop(e(this));n.$doc.on("mousemove",function(e){n.mouseElPos=e.pageY-n.elementPos;n.borders()});e(t).on("mouseup blur resize",function(){n.off("mousemove");n.off("mouseup")});e(t).on("resize",function(){n.docH=n.$doc.height();n.limitBottom=parseInt(n.docH-n.$element.height()-n.options.limitBottom,10)})})};o.prototype.borders=function(){if(this.mouseElPos>this.limitTop){this.css(this.$element,"top",this.mouseElPos);this.css(this.containerTop,"height",this.mouseElPos);this.css(this.containerBottom,"top",this.mouseElPos+this.elementH);if(this.mouseElPos>this.limitBottom){this.css(this.$element,"top",this.limitBottom);this.css(this.containerTop,"height",this.limitBottom);this.css(this.containerBottom,"top",this.limitBottom+this.elementH)}}else if(this.mouseElPos<=this.limitTop){this.css(this.$element,"top",this.limitTop);this.css(this.containerTop,"height",this.limitTop);this.css(this.containerBottom,"top",this.limitTop+this.elementH)}};e.fn[i]=function(t){return this.each(function(){e.data(this,"plugin_"+i)||e.data(this,"plugin_"+i,new o(this,t))})}})(jQuery,window,document);